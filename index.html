<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue Template Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .banner {
            background: linear-gradient(90deg, red, orange);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .top-bar {
            display: flex;
            justify-content: space-between;
            background-color: #333;
            padding: 15px;
            color: white;
        }
        .top-bar select {
            padding: 6px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
        }
        .summary-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #eee;
            padding: 8px 15px;
            border-bottom: 1px solid #ccc;
            font-family: Arial, sans-serif;
            color: #333;
            font-weight: bold;
        }
        .summary-bar input {
            border: none;
            background: none;
            font-weight: bold;
            color: #333;
            width: 100%;
            text-align: center;
            outline: none;
            cursor: text;
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 15px;
        }
        .form-section {
            flex: 1;
        }
        .output-section {
            flex: 1;
            background: #f9f9f9;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            white-space: pre-wrap;
            font-size: 14px;
        }
        .form-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .form-group label {
            flex: 1;
            font-weight: bold;
            margin-right: 8px;
            font-size: 14px;
        }
        .form-group input, .form-group textarea {
            flex: 2;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background-color: red;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: orange;
        }
        footer {
            text-align: center;
            background-color: #333;
            color: white;
            padding: 10px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>
<body>

<div class="banner">
    <h1>Issue Template Generator</h1>
</div>

<div class="summary-bar">
    <input type="text" id="summary-bar" readonly value="Priority || Customer || Access ID || Issue Type" />
</div>

<div class="top-bar">
    <div>
        <label for="issue-type">Select Issue Type:</label>
        <select id="issue-type" required>
            <option value="">-- Select --</option>
            <option value="MultiWifi - Hinder">MultiWifi - Hinder</option>
            <option value="MultiWifi - No Connection">MultiWifi - No Connection</option>
            <option value="Telefonie - Feature Issues">Telephony - Feature Issues</option>
            <option value="Telefonie - No in- or outgoing calls">Telephony - No In/Out Calls</option>
            <option value="Telefonie - One way audio">Telephony - One Way Audio</option>
            <option value="Telefonie - Quality issues">Telephony - Quality Issues</option>
            <option value="Data - No Connection">Data - No Connection</option>
            <option value="Data - Packetloss">Data - Packetloss</option>
            <option value="Data - Performance Issue">Data - Performance Issue</option>
            <option value="Data - Reachability IP">Data - Reachability IP</option>
            <option value="Data - Speed Issues">Data - Speed Issues</option>
        </select>
    </div>
    <div>
        <label for="priority">Select Priority:</label>
        <select id="priority" required>
            <option value="">-- Select --</option>
            <option value="P1">P1</option>
            <option value="P2">P2</option>
            <option value="P3">P3</option>
            <option value="P4">P4</option>
        </select>
    </div>
</div>

<div class="container">
    <div class="form-section">
        <form id="template-form">
            <div id="dynamic-fields">
                <!-- Dynamic fields will be inserted here based on issue type -->
            </div>
            <button type="submit">Generate Template</button>
        </form>
    </div>
    <div class="output-section">
        <h2>Generated Template:</h2>
        <div id="template-output"></div>
    </div>
</div>

<footer>
    Â© 2025 Your Company Name. All rights reserved.
</footer>

<script>
    let issueTemplates = {};

    // Fetch issueTemplates.json on page load
    document.addEventListener("DOMContentLoaded", async () => {
        try {
            const response = await fetch("data/issueTemplates.json");
            issueTemplates = await response.json();
            console.log("Templates loaded successfully", issueTemplates);
        } catch (error) {
            console.error("Error loading issue templates:", error);
        }
    });

    document.getElementById("issue-type").addEventListener("change", function () {
        const issueType = this.value;
        const dynamicFieldsDiv = document.getElementById("dynamic-fields");
        dynamicFieldsDiv.innerHTML = "";

        if (issueTemplates[issueType]) {
            issueTemplates[issueType].forEach(field => {
                const div = document.createElement("div");
                div.classList.add("form-group");

                const label = document.createElement("label");
                label.textContent = field;

                const input = document.createElement("input");
                input.type = "text";
                input.setAttribute("label", field);

                div.appendChild(label);
                div.appendChild(input);
                dynamicFieldsDiv.appendChild(div);
            });
        }
        updateSummary();
    });

function updateSummary() {
    const priority = document.getElementById("priority").value || "Priority";
    const issueType = document.getElementById("issue-type").value || "Issue Type";

    // Get values dynamically from the input fields
    const customer = document.querySelector("input[label='Company name:']")?.value || "Customer";
    const accessID = document.querySelector("input[label='Access ID:']")?.value || "Access ID";

    // Update the summary bar
    document.getElementById("summary-bar").value = `${priority} || ${customer} || ${accessID} || ${issueType}`;
}

// Attach event listeners to dynamically update the summary bar
document.getElementById("priority").addEventListener("change", updateSummary);
document.getElementById("issue-type").addEventListener("change", updateSummary);

// Dynamically add event listeners to input fields when the template is loaded
function attachFieldListeners() {
    const dynamicFieldsDiv = document.getElementById("dynamic-fields");
    const inputs = dynamicFieldsDiv.querySelectorAll("input");

    inputs.forEach(input => {
        input.addEventListener("input", updateSummary);
    });
}

// Update the attachFieldListeners call when the issue type changes
document.getElementById("issue-type").addEventListener("change", function () {
    const issueType = this.value;
    const dynamicFieldsDiv = document.getElementById("dynamic-fields");
    dynamicFieldsDiv.innerHTML = "";

    if (issueTemplates[issueType]) {
        issueTemplates[issueType].forEach(field => {
            const div = document.createElement("div");
            div.classList.add("form-group");

            const label = document.createElement("label");
            label.textContent = field;

            const input = document.createElement("input");
            input.type = "text";
            input.setAttribute("label", field);

            div.appendChild(label);
            div.appendChild(input);
            dynamicFieldsDiv.appendChild(div);
        });

        attachFieldListeners(); // Add listeners to the new inputs
    }
    updateSummary(); // Update the summary with new fields
});
</script>

</body>
</html>
